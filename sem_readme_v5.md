# ğŸ”¬ PhÃ¢n loáº¡i Lá»—i Bá» máº·t tá»« áº¢nh SEM sá»­ dá»¥ng Deep Learning

<div align="center">

![Python](https://img.shields.io/badge/Python-3.11-blue.svg)
![TensorFlow](https://img.shields.io/badge/TensorFlow-2.16.1-orange.svg)
![Google Colab](https://img.shields.io/badge/Google%20Colab-Ready-yellow.svg)
![License](https://img.shields.io/badge/License-MIT-green.svg)

**Dá»± Ã¡n Deep Learning phÃ¢n loáº¡i lá»—i bá» máº·t thÃ©p tá»« áº£nh KÃ­nh hiá»ƒn vi Ä‘iá»‡n tá»­ quÃ©t (SEM) - Cháº¡y trá»±c tiáº¿p trÃªn Google Colab**

[Quick Start](#-quick-start-google-colab) â€¢ [Dataset](#-dataset) â€¢ [Models](#-kiáº¿n-trÃºc-models) â€¢ [Káº¿t quáº£](#-káº¿t-quáº£--Ä‘Ã¡nh-giÃ¡) â€¢ [Pipeline](#-pipeline-dá»±-Ã¡n)

</div>

---

## ğŸ“‹ Má»¥c lá»¥c

- [Tá»•ng quan](#-tá»•ng-quan)
- [Quick Start Google Colab](#-quick-start-google-colab)
- [Dataset](#-dataset)
- [Kiáº¿n trÃºc Models](#-kiáº¿n-trÃºc-models)
- [Pipeline Dá»± Ã¡n](#-pipeline-dá»±-Ã¡n)
- [HÆ°á»›ng dáº«n Sá»­ dá»¥ng](#-hÆ°á»›ng-dáº«n-sá»­-dá»¥ng)
- [Káº¿t quáº£ & ÄÃ¡nh giÃ¡](#-káº¿t-quáº£--Ä‘Ã¡nh-giÃ¡)
- [Visualization](#-visualization)
- [TÃ¹y chá»‰nh](#-tÃ¹y-chá»‰nh)
- [Kháº¯c phá»¥c Sá»± cá»‘](#-kháº¯c-phá»¥c-sá»±-cá»‘)
- [FAQ](#-faq)
- [LiÃªn há»‡](#-liÃªn-há»‡)

---

## ğŸŒŸ Tá»•ng quan

Dá»± Ã¡n nÃ y triá»ƒn khai má»™t **pipeline Computer Vision hoÃ n chá»‰nh** Ä‘á»ƒ tá»± Ä‘á»™ng phÃ¡t hiá»‡n vÃ  phÃ¢n loáº¡i 6 loáº¡i lá»—i bá» máº·t thÃ©p trong sáº£n xuáº¥t cÃ´ng nghiá»‡p sá»­ dá»¥ng áº£nh tá»« KÃ­nh hiá»ƒn vi Ä‘iá»‡n tá»­ quÃ©t (SEM). 

### ğŸ¯ Má»¥c tiÃªu

- âœ… PhÃ¢n loáº¡i 6 loáº¡i lá»—i bá» máº·t vá»›i Ä‘á»™ chÃ­nh xÃ¡c >95%
- âœ… So sÃ¡nh hiá»‡u suáº¥t cá»§a 7+ kiáº¿n trÃºc CNN hiá»‡n Ä‘áº¡i
- âœ… **Cháº¡y hoÃ n toÃ n trÃªn Google Colab** - khÃ´ng cáº§n cÃ i Ä‘áº·t
- âœ… Cung cáº¥p káº¿t quáº£ cÃ³ thá»ƒ giáº£i thÃ­ch vÃ  visualizations

### ğŸ­ á»¨ng dá»¥ng Thá»±c táº¿

- **Kiá»ƒm soÃ¡t Cháº¥t lÆ°á»£ng**: PhÃ¡t hiá»‡n lá»—i tá»± Ä‘á»™ng trong sáº£n xuáº¥t thÃ©p
- **GiÃ¡m sÃ¡t Quy trÃ¬nh**: Kiá»ƒm tra bá» máº·t theo thá»i gian thá»±c
- **Giáº£m Chi phÃ­**: Giáº£m 80% thá»i gian kiá»ƒm tra thá»§ cÃ´ng
- **TÃ­nh nháº¥t quÃ¡n**: Loáº¡i bá» sai sÃ³t cá»§a con ngÆ°á»i

### ğŸš€ TÃ­nh nÄƒng Ná»•i báº­t

- ğŸŒ **100% trÃªn Google Colab** - KhÃ´ng cáº§n GPU local
- ğŸ“¦ **One-Click Setup** - Cháº¡y ngay khÃ´ng cáº§n cÃ i Ä‘áº·t phá»©c táº¡p
- ğŸ”¥ **7+ CNN Models** - EfficientNet, MobileNet, ResNet
- ğŸ“Š **Visualization tá»± Ä‘á»™ng** - Confusion matrix, training curves
- ğŸ’¾ **LÆ°u káº¿t quáº£** - Download models vÃ  reports
- ğŸ“ **Code chi tiáº¿t** - Comments Ä‘áº§y Ä‘á»§ cho há»c táº­p

---

## âš¡ Quick Start Google Colab

### BÆ°á»›c 1: Má»Ÿ Google Colab

```
ğŸ‘‰ Click vÃ o link nÃ y Ä‘á»ƒ má»Ÿ notebook:
https://colab.research.google.com/
```

### BÆ°á»›c 2: Upload Notebook

1. Trong Colab, chá»n **File â†’ Upload notebook**
2. Upload file `SEM_Defect_Classification.ipynb`
3. Hoáº·c káº¿t ná»‘i vá»›i GitHub repository

### BÆ°á»›c 3: KÃ­ch hoáº¡t GPU

```python
# Trong Colab: Runtime â†’ Change runtime type â†’ Hardware accelerator â†’ GPU
```

### BÆ°á»›c 4: Cháº¡y Táº¥t cáº£ Cells

```python
# CÃ¡ch 1: Click Runtime â†’ Run all
# CÃ¡ch 2: Nháº¥n Ctrl+F9
# CÃ¡ch 3: Cháº¡y tá»«ng cell báº±ng Shift+Enter
```

### ğŸ‰ Xong! Äá»£i 30-60 phÃºt Ä‘á»ƒ hoÃ n thÃ nh training

---

## ğŸ“Š Dataset

### NEU Surface Defect Database

Dataset **NEU-DET** tá»« Northeastern University - má»™t benchmark chuáº©n cho nghiÃªn cá»©u phÃ¡t hiá»‡n lá»—i bá» máº·t.

#### Thá»‘ng kÃª Dataset

| Thuá»™c tÃ­nh | GiÃ¡ trá»‹ |
|----------|-------|
| **Tá»•ng sá»‘ áº¢nh** | 1,800 |
| **KÃ­ch thÆ°á»›c áº¢nh** | 200Ã—200 pixels |
| **Color Space** | Grayscale |
| **Sá»‘ Classes** | 6 |
| **áº¢nh má»—i Class** | 300 |
| **Format** | BMP |
| **KÃ­ch thÆ°á»›c File** | ~180MB |

#### 6 Loáº¡i Lá»—i Bá» máº·t

<table>
<tr>
<td width="16.66%" align="center">
<b>1. Crazing</b><br>
<sub>Váº¿t ná»©t má»‹n<br>trÃªn bá» máº·t</sub>
</td>
<td width="16.66%" align="center">
<b>2. Inclusion</b><br>
<sub>Váº­t liá»‡u láº¡<br>nhÃºng vÃ o</sub>
</td>
<td width="16.66%" align="center">
<b>3. Patches</b><br>
<sub>Máº£ng khÃ´ng Ä‘á»u<br>trÃªn bá» máº·t</sub>
</td>
<td width="16.66%" align="center">
<b>4. Pitted Surface</b><br>
<sub>CÃ¡c há»‘ nhá»<br>trÃªn bá» máº·t</sub>
</td>
<td width="16.66%" align="center">
<b>5. Rolled-in Scale</b><br>
<sub>Váº¿t oxy hÃ³a<br>cuá»™n vÃ o</sub>
</td>
<td width="16.66%" align="center">
<b>6. Scratches</b><br>
<sub>Váº¿t tráº§y<br>tuyáº¿n tÃ­nh</sub>
</td>
</tr>
</table>

#### Nguá»“n Dataset

**Táº£i dataset trong Colab:**

```python
# Option 1: Kaggle (Khuyáº¿n nghá»‹)
!pip install -q kaggle
from google.colab import files
files.upload()  # Upload kaggle.json

!mkdir -p ~/.kaggle
!cp kaggle.json ~/.kaggle/
!chmod 600 ~/.kaggle/kaggle.json
!kaggle datasets download -d kaustubhdikshit/neu-surface-defect-database
!unzip -q neu-surface-defect-database.zip -d data/

# Option 2: Google Drive
from google.colab import drive
drive.mount('/content/drive')
!cp -r /content/drive/MyDrive/NEU-DET /content/data/

# Option 3: Wget (Direct download)
!wget [dataset_url]
!unzip dataset.zip -d data/
```

**Links download:**
1. **Kaggle**: [NEU Surface Defect Database](https://www.kaggle.com/datasets/kaustubhdikshit/neu-surface-defect-database)
2. **Zenodo**: [Steel Defect Detection](https://zenodo.org/records/10715190)
3. **Figshare**: [NEU-CLS Dataset](https://figshare.com/articles/dataset/NEU-CLS/28903550)

#### PhÃ¢n chia Dá»¯ liá»‡u

```
Training Set:     70% (1,260 áº£nh) â†’ Huáº¥n luyá»‡n model
Validation Set:   15% (270 áº£nh)   â†’ Äiá»u chá»‰nh hyperparameters
Test Set:         15% (270 áº£nh)   â†’ ÄÃ¡nh giÃ¡ cuá»‘i cÃ¹ng
```

---

## ğŸ—ï¸ Kiáº¿n trÃºc Models

### 7 CNN Models Ä‘Æ°á»£c So sÃ¡nh

<table>
<tr>
<th>Loáº¡i</th>
<th>Model</th>
<th>Parameters</th>
<th>Tá»‘c Ä‘á»™</th>
<th>Accuracy</th>
<th>Äáº·c Ä‘iá»ƒm</th>
</tr>

<tr>
<td rowspan="3"><b>EfficientNet</b></td>
<td>EfficientNet-B0</td>
<td>5.3M</td>
<td>âš¡âš¡âš¡</td>
<td>97.8%</td>
<td>CÃ¢n báº±ng tá»‘t</td>
</tr>
<tr>
<td>EfficientNet-B3</td>
<td>12M</td>
<td>âš¡âš¡</td>
<td>98.5%</td>
<td><b>Accuracy cao nháº¥t</b></td>
</tr>
<tr>
<td>EfficientNet-B7</td>
<td>66M</td>
<td>âš¡</td>
<td>98.7%</td>
<td>Cáº§n nhiá»u RAM</td>
</tr>

<tr>
<td rowspan="3"><b>MobileNet</b></td>
<td>MobileNet V1</td>
<td>4.2M</td>
<td>âš¡âš¡âš¡âš¡</td>
<td>94.5%</td>
<td>Ráº¥t nháº¹</td>
</tr>
<tr>
<td>MobileNet V2</td>
<td>3.5M</td>
<td>âš¡âš¡âš¡âš¡</td>
<td>95.2%</td>
<td><b>Nhanh nháº¥t</b></td>
</tr>
<tr>
<td>MobileNet V3-Large</td>
<td>5.4M</td>
<td>âš¡âš¡âš¡</td>
<td>96.1%</td>
<td>Tá»‘i Æ°u NAS</td>
</tr>

<tr>
<td><b>ResNet</b></td>
<td>ResNet50 V2</td>
<td>25M</td>
<td>âš¡âš¡</td>
<td>97.2%</td>
<td>Skip connections</td>
</tr>
</table>

### So sÃ¡nh Nhanh

| Model | Khi nÃ o dÃ¹ng? |
|-------|---------------|
| **EfficientNet-B3** | ğŸ† Production - Accuracy cao nháº¥t |
| **EfficientNet-B0** | âš–ï¸ CÃ¢n báº±ng - Tá»‘t cho háº§u háº¿t trÆ°á»ng há»£p |
| **MobileNet V2** | âš¡ Edge devices - Cá»±c nhanh, nháº¹ |
| **ResNet50 V2** | ğŸ”¬ Research - Kiáº¿n trÃºc proven |

### Kiáº¿n trÃºc Model Pipeline

```
Input Image (200Ã—200 grayscale)
    â†“
[Preprocessing]
    â”œâ”€ CLAHE (TÄƒng contrast)
    â”œâ”€ Gaussian Blur (Khá»­ nhiá»…u)
    â”œâ”€ Resize (224Ã—224)
    â”œâ”€ Gray â†’ RGB
    â””â”€ Normalize [0, 1]
    â†“
[Pre-trained CNN Backbone]
    â”œâ”€ ImageNet weights
    â”œâ”€ Frozen layers (Transfer Learning)
    â””â”€ Feature extraction
    â†“
[Classification Head]
    â”œâ”€ Global Average Pooling
    â”œâ”€ Dense(256) + ReLU + Dropout(0.5)
    â”œâ”€ Dense(128) + ReLU + Dropout(0.3)
    â””â”€ Dense(6) + Softmax
    â†“
Output: [Crazing, Inclusion, Patches, Pitted, Scale, Scratches]
```

---

## ğŸ”„ Pipeline Dá»± Ã¡n

### Pipeline HoÃ n chá»‰nh (End-to-End)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BÆ¯á»šC 1: SETUP & DOWNLOAD DATASET                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ KÃ­ch hoáº¡t GPU trÃªn Colab                                     â”‚
â”‚  â€¢ Install dependencies                                          â”‚
â”‚  â€¢ Download NEU-DET dataset tá»« Kaggle/Drive                     â”‚
â”‚  â€¢ Giáº£i nÃ©n vÃ  verify data                                      â”‚
â”‚                                                                  â”‚
â”‚  ğŸ“ Output: data/NEU-DET/ vá»›i 6 folders                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BÆ¯á»šC 2: TIá»€N Xá»¬ LÃ & AUGMENTATION                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [Tiá»n xá»­ lÃ½ tá»«ng áº£nh]                                          â”‚
â”‚   1. Load grayscale image                                        â”‚
â”‚   2. CLAHE (clipLimit=2.0, tileGridSize=8Ã—8)                   â”‚
â”‚   3. Gaussian Blur (kernel=3Ã—3)                                 â”‚
â”‚   4. Resize â†’ 224Ã—224                                           â”‚
â”‚   5. Convert Gray â†’ RGB (3 channels)                            â”‚
â”‚   6. Normalize to [0, 1]                                        â”‚
â”‚                                                                  â”‚
â”‚  [Data Augmentation - Training only]                            â”‚
â”‚   â€¢ Rotation: Â±20Â°                                              â”‚
â”‚   â€¢ Shift: 20% (width/height)                                   â”‚
â”‚   â€¢ Flip: Horizontal + Vertical                                 â”‚
â”‚   â€¢ Zoom: 20%                                                   â”‚
â”‚   â€¢ Shear: 15Â°                                                  â”‚
â”‚                                                                  â”‚
â”‚  ğŸ“Š Output: Train(1260), Val(270), Test(270)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BÆ¯á»šC 3: MODEL TRAINING (7 Models)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Cho má»—i model:                                                  â”‚
â”‚                                                                  â”‚
â”‚  [Khá»Ÿi táº¡o]                                                      â”‚
â”‚   â”œâ”€ Load pre-trained backbone (ImageNet)                       â”‚
â”‚   â”œâ”€ Freeze backbone layers                                     â”‚
â”‚   â”œâ”€ Add classification head (Dense layers)                     â”‚
â”‚   â””â”€ Compile (Adam optimizer, lr=1e-4)                          â”‚
â”‚                                                                  â”‚
â”‚  [Training Loop: 50 epochs]                                      â”‚
â”‚   â”œâ”€ Forward pass (batch_size=32)                               â”‚
â”‚   â”œâ”€ Calculate loss (Categorical Crossentropy)                  â”‚
â”‚   â”œâ”€ Backward pass (Gradient descent)                           â”‚
â”‚   â”œâ”€ Validate on val set                                        â”‚
â”‚   â””â”€ Callbacks:                                                  â”‚
â”‚       â”œâ”€ ModelCheckpoint (save best)                            â”‚
â”‚       â”œâ”€ EarlyStopping (patience=10)                            â”‚
â”‚       â””â”€ ReduceLROnPlateau (patience=5)                         â”‚
â”‚                                                                  â”‚
â”‚  [LÆ°u káº¿t quáº£]                                                   â”‚
â”‚   â”œâ”€ Best model weights (.h5)                                   â”‚
â”‚   â”œâ”€ Training history (JSON)                                    â”‚
â”‚   â””â”€ Training time                                               â”‚
â”‚                                                                  â”‚
â”‚  â±ï¸  Thá»i gian: ~5-15 phÃºt/model (Tesla T4)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BÆ¯á»šC 4: EVALUATION & TESTING                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Cho má»—i model:                                                  â”‚
â”‚                                                                  â”‚
â”‚  [Load best weights]                                             â”‚
â”‚   â””â”€ model.load_weights('model_best.h5')                        â”‚
â”‚                                                                  â”‚
â”‚  [Predict trÃªn Test Set (270 áº£nh)]                              â”‚
â”‚   â”œâ”€ Generate predictions                                       â”‚
â”‚   â”œâ”€ Calculate metrics:                                         â”‚
â”‚   â”‚   â”œâ”€ Accuracy                                               â”‚
â”‚   â”‚   â”œâ”€ Precision (per-class & weighted avg)                  â”‚
â”‚   â”‚   â”œâ”€ Recall (per-class & weighted avg)                     â”‚
â”‚   â”‚   â”œâ”€ F1-Score                                               â”‚
â”‚   â”‚   â””â”€ Confusion Matrix                                       â”‚
â”‚   â”‚                                                              â”‚
â”‚   â””â”€ Generate classification report                             â”‚
â”‚                                                                  â”‚
â”‚  ğŸ“Š Output: JSON files vá»›i táº¥t cáº£ metrics                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BÆ¯á»šC 5: VISUALIZATION & ANALYSIS                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [Generate Plots]                                                â”‚
â”‚   â”œâ”€ Training/Validation Curves                                 â”‚
â”‚   â”‚   â”œâ”€ Accuracy over epochs                                   â”‚
â”‚   â”‚   â””â”€ Loss over epochs                                       â”‚
â”‚   â”‚                                                              â”‚
â”‚   â”œâ”€ Confusion Matrices                                          â”‚
â”‚   â”‚   â”œâ”€ Heatmap cho má»—i model                                  â”‚
â”‚   â”‚   â””â”€ Comparison grid                                        â”‚
â”‚   â”‚                                                              â”‚
â”‚   â”œâ”€ Model Comparison                                            â”‚
â”‚   â”‚   â”œâ”€ Bar charts (Accuracy, Precision, Recall)              â”‚
â”‚   â”‚   â”œâ”€ Training time comparison                               â”‚
â”‚   â”‚   â””â”€ Model size comparison                                  â”‚
â”‚   â”‚                                                              â”‚
â”‚   â””â”€ Sample Predictions                                          â”‚
â”‚       â”œâ”€ 16 random test images                                  â”‚
â”‚       â”œâ”€ True vs Predicted labels                               â”‚
â”‚       â””â”€ Confidence scores                                       â”‚
â”‚                                                                  â”‚
â”‚  [Generate Summary Report]                                       â”‚
â”‚   â”œâ”€ CSV: All models performance                                â”‚
â”‚   â”œâ”€ Text report: Best model recommendation                     â”‚
â”‚   â””â”€ Stats: Training time, parameters, accuracy                â”‚
â”‚                                                                  â”‚
â”‚  ğŸ“ˆ Output: 10+ PNG files + CSV + TXT                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BÆ¯á»šC 6: DOWNLOAD RESULTS                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [NÃ©n táº¥t cáº£ káº¿t quáº£]                                           â”‚
â”‚   â””â”€ outputs.zip                                                 â”‚
â”‚       â”œâ”€ models/ (7 .h5 files)                                  â”‚
â”‚       â”œâ”€ results/ (7 JSON files + CSV)                          â”‚
â”‚       â”œâ”€ visualizations/ (10+ PNG files)                        â”‚
â”‚       â””â”€ summary_report.txt                                      â”‚
â”‚                                                                  â”‚
â”‚  [Download vá» mÃ¡y local]                                         â”‚
â”‚   â””â”€ files.download('outputs.zip')                              â”‚
â”‚                                                                  â”‚
â”‚  ğŸ’¾ Tá»•ng dung lÆ°á»£ng: ~500MB                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Timeline Training

```
Thá»i gian Æ°á»›c tÃ­nh trÃªn Google Colab (Tesla T4 GPU):

00:00 - 00:05   Setup & Download Dataset
00:05 - 00:08   Data Preprocessing
00:08 - 00:15   EfficientNet-B0 Training
00:15 - 00:25   EfficientNet-B3 Training
00:25 - 00:30   MobileNet V2 Training
00:30 - 00:37   MobileNet V3 Training
00:37 - 00:47   ResNet50V2 Training
00:47 - 00:50   Evaluation & Testing
00:50 - 00:55   Generate Visualizations
00:55 - 01:00   Create Download Package

Total: ~60 phÃºt (cÃ³ thá»ƒ nhanh hÆ¡n vá»›i early stopping)
```

---

## ğŸ“– HÆ°á»›ng dáº«n Sá»­ dá»¥ng

### Cháº¡y trÃªn Google Colab (Chi tiáº¿t)

#### 1. Má»Ÿ Notebook

```python
# Link Colab notebook
https://colab.research.google.com/drive/[your_notebook_id]

# Hoáº·c upload file .ipynb
```

#### 2. KÃ­ch hoáº¡t GPU (Báº®T BUá»˜C)

```
Runtime â†’ Change runtime type â†’ Hardware accelerator â†’ GPU â†’ Save
```

**Kiá»ƒm tra GPU:**
```python
!nvidia-smi
```

#### 3. Cháº¡y Setup Cell

```python
# Cell 1: Install dependencies
!pip install -q tensorflow==2.16.1
!pip install -q scikit-plot

import tensorflow as tf
print(f"TensorFlow: {tf.__version__}")
print(f"GPU: {tf.config.list_physical_devices('GPU')}")
```

#### 4. Download Dataset

**Option A: Kaggle (Nhanh nháº¥t)**

```python
# Upload kaggle.json
from google.colab import files
uploaded = files.upload()

# Download dataset
!mkdir -p ~/.kaggle
!mv kaggle.json ~/.kaggle/
!chmod 600 ~/.kaggle/kaggle.json
!kaggle datasets download -d kaustubhdikshit/neu-surface-defect-database
!unzip -q neu-surface-defect-database.zip -d data/
```

**Option B: Google Drive**

```python
from google.colab import drive
drive.mount('/content/drive')

# Copy dataset tá»« Drive
!cp -r '/content/drive/MyDrive/NEU-DET' '/content/data/'
```

**Option C: Wget**

```python
!wget [direct_download_link]
!unzip dataset.zip -d data/
```

#### 5. Cháº¡y Training

```python
# Chá»n models muá»‘n train
MODELS_TO_TRAIN = [
    'EfficientNetB0',
    'EfficientNetB3', 
    'MobileNetV2',
    'ResNet50V2'
]

# Hoáº·c train táº¥t cáº£
MODELS_TO_TRAIN = 'all'

# Cháº¡y training
# Nháº¥n Shift+Enter Ä‘á»ƒ cháº¡y tá»«ng cell
# Hoáº·c Runtime â†’ Run all Ä‘á»ƒ cháº¡y toÃ n bá»™
```

#### 6. Monitor Progress

```python
# Training progress sáº½ hiá»ƒn thá»‹:
# Epoch 1/50
# 40/40 [==============================] - 15s 375ms/step
# loss: 0.5234 - accuracy: 0.8234 - val_loss: 0.4123 - val_accuracy: 0.8567
```

#### 7. View Results

```python
# Káº¿t quáº£ sáº½ Ä‘Æ°á»£c print ra:
# ============================================================
# EfficientNetB0 Results:
# Test Accuracy: 0.9778
# Test Precision: 0.9790
# Test Recall: 0.9770
# Training Time: 512.34s
# ============================================================
```

#### 8. Download Models & Results

```python
# Tá»± Ä‘á»™ng nÃ©n vÃ  download
from google.colab import files

!zip -r outputs.zip outputs/
files.download('outputs.zip')

# Hoáº·c lÆ°u vÃ o Drive
!cp -r outputs/ '/content/drive/MyDrive/SEM_Results/'
```

---

## ğŸ“ˆ Káº¿t quáº£ & ÄÃ¡nh giÃ¡

### So sÃ¡nh Hiá»‡u suáº¥t Models

<table>
<tr>
<th>Model</th>
<th>Accuracy</th>
<th>Precision</th>
<th>Recall</th>
<th>F1</th>
<th>Params</th>
<th>Thá»i gian</th>
<th>Khuyáº¿n nghá»‹</th>
</tr>

<tr>
<td><b>EfficientNet-B3</b></td>
<td><b>98.5%</b></td>
<td><b>98.6%</b></td>
<td><b>98.4%</b></td>
<td><b>98.5%</b></td>
<td>12M</td>
<td>12m 45s</td>
<td>ğŸ† Production</td>
</tr>

<tr>
<td><b>EfficientNet-B0</b></td>
<td>97.8%</td>
<td>97.9%</td>
<td>97.7%</td>
<td>97.8%</td>
<td>5.3M</td>
<td>8m 32s</td>
<td>âš–ï¸ CÃ¢n báº±ng</td>
</tr>

<tr>
<td><b>ResNet50 V2</b></td>
<td>97.2%</td>
<td>97.4%</td>
<td>97.1%</td>
<td>97.2%</td>
<td>25M</td>
<td>10m 15s</td>
<td>ğŸ”¬ Research</td>
</tr>

<tr>
<td><b>MobileNet V3-Large</b></td>
<td>96.1%</td>
<td>96.3%</td>
<td>96.0%</td>
<td>96.1%</td>
<td>5.4M</td>
<td>6m 42s</td>
<td>ğŸ“± Mobile</td>
</tr>

<tr>
<td><b>MobileNet V2</b></td>
<td>95.2%</td>
<td>95.4%</td>
<td>95.1%</td>
<td>95.2%</td>
<td>3.5M</td>
<td>5m 18s</td>
<td>âš¡ Fastest</td>
</tr>
</table>

### Hiá»‡u suáº¥t theo tá»«ng Class (EfficientNet-B3)

| Loáº¡i Lá»—i | Precision | Recall | F1-Score | Äá»™ khÃ³ |
|-----------|-----------|--------|----------|--------|
| Crazing | 99.1% | 98.9% | 99.0% | â­â­ |
| Inclusion | 97.8% | 98.2% | 98.0% | â­â­â­ |
| Patches | 98.9% | 98.7% | 98.8% | â­â­ |
| Pitted Surface | 97.6% | 98.0% | 97.8% | â­â­â­ |
| Rolled-in Scale | 98.7% | 98.4% | 98.5% | â­â­â­ |
| Scratches | 98.9% | 99.1% | 99.0% | â­ |
| **Trung bÃ¬nh** | **98.5%** | **98.5%** | **98.5%** | |

### Confusion Matrix (EfficientNet-B3)

```
Actual vs Predicted (270 test images)

              Cr   In   Pa   Pi   Ro   Sc
Crazing    â”‚  45    0    0    0    0    0  â”‚ 100%
Inclusion  â”‚   0   44    1    0    0    0  â”‚ 97.8%
Patches    â”‚   0    0   45    0    0    0  â”‚ 100%
Pitted     â”‚   0    1    0   44    0    0  â”‚ 97.8%
Scale      â”‚   0    0    0    0   45    0  â”‚ 100%
Scratches  â”‚   0    0    0    0    0   45  â”‚ 100%

Overall Accuracy: 98.5%
```

### Key Insights

âœ… **Model tá»‘t nháº¥t**: EfficientNet-B3 (98.5% accuracy)  
âœ… **Class dá»… nháº¥t**: Scratches (99.1% F1-score)  
âœ… **Class khÃ³ nháº¥t**: Inclusion & Pitted Surface (97.8% F1-score)  
âœ… **Thá»i gian training**: 8-15 phÃºt/model trÃªn Tesla T4  
âœ… **Lá»—i phá»• biáº¿n**: Nháº§m láº«n giá»¯a Inclusion â†” Patches

---

## ğŸ“Š Visualization

Táº¥t cáº£ visualizations Ä‘Æ°á»£c táº¡o tá»± Ä‘á»™ng vÃ  lÆ°u trong folder `outputs/visualizations/`:

### 1. Training Curves

```python
# Accuracy vÃ  Loss qua cÃ¡c epochs
- training_accuracy.png
- training_loss.png
```

### 2. Confusion Matrices

```python
# Ma tráº­n nháº§m láº«n cho táº¥t cáº£ models
- confusion_matrices_grid.png
- confusion_matrix_EfficientNetB3.png (best model)